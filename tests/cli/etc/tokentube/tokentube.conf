crypto {
	cipher = aes-256-cfb
	hash = sha-256
	kdf = scrypt
	kdf-iterations = 65536
}


storage {
	key-files {
		directory = etc/tokentube/keys
		filename-hash = null
	}
	user-files {
		directory = boot/tokentube/user
		filename-hash = null
	}
	otp-files {
		directory = boot/tokentube/otp
		filename-hash = null
	}
	uhd-files {
		directory = var/spool/tokentube/helpdesk
		filename-hash = null
	}
}


user {
	auto-enrollment {
		uid-minimum = -1
		uid-maximum = -1
		gid-minimum = -1
		gid-maximum = -1
		groups = {}
	}
}


otp {
	bits = 64
}


plugins {
	enabled = { "lua", "python", "exec", "log", "syslog" }
	plugin python {
		library = "usr/lib/tokentube/plugins.d/libtokentube-plugin-python.so"
		config  = "etc/tokentube/conf.d/plugin-python.conf"
	}
	plugin exec {
		library = "usr/lib/tokentube/plugins.d/libtokentube-plugin-exec.so"
		config  = "etc/tokentube/conf.d/plugin-exec.conf"
	}
	plugin log {
		library = "usr/lib/tokentube/plugins.d/libtokentube-plugin-log.so"
	}
	plugin lua {
		library = "usr/lib/tokentube/plugins.d/libtokentube-plugin-lua.so"
		config  = "etc/tokentube/conf.d/plugin-lua.conf"
	}
	plugin syslog {
		library = "usr/lib/tokentube/plugins.d/libtokentube-plugin-syslog.so"
		disable {
			event = { "user" }
		}
	}
}


runtime {
	log {
		level = "warn"
	}
}

